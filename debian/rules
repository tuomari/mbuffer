#!/usr/bin/make -f
#
# Build rules for mbuffer, the stream buffering tool 

build: build-stamp
build-stamp:
	dh build --before auto_configure
ifneq "$(wildcard /usr/share/misc/config.sub)" ""
	cp -f /usr/share/misc/config.sub config.sub
endif
ifneq "$(wildcard /usr/share/misc/config.guess)" ""
	cp -f /usr/share/misc/config.guess config.guess
endif
	dh_auto_configure -- CFLAGS="$(CFLAGS)" LDFLAGS="-Wl,-z,defs"
	dh build --before auto_test
	dh build --after auto_test
	touch $@

clean: 
	dh $@

install: build
	dh $@ --before auto_install
	dh_auto_install -- DESTDIR=$(CURDIR)/debian/mbuffer install
	dh $@ --remaining

# Build architecture-independent files here.
binary-indep: install
# We have nothing to do by default.

# Build architecture-dependent files here.
binary-arch: install
	dh $@

binary: binary-indep binary-arch
.PHONY: build clean binary-indep binary-arch binary install 
